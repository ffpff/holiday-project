<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>深圳到大理三日游行程规划表</title>
    
    <!-- 引入外部资源 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* 全局样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            color: #333;
            line-height: 1.4;
            background: #f8f9fa;
        }
        
        /* A4纸张尺寸 */
        .travel-plan {
            width: 210mm;
            min-height: 297mm;
            max-width: 210mm;
            margin: 20px auto;
            padding: 10mm;
            background: white;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-radius: 8px;
            position: relative;
        }
        
        /* 保存按钮 */
        .save-image-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .save-image-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .save-image-button i {
            margin-right: 8px;
        }
        
        /* 标题区域 */
        .header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 15px;
        }
        
        .main-title {
            font-size: 28px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
        }
        
        .sub-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .weather-info {
            font-size: 12px;
            color: #888;
            background: #f0f7ff;
            padding: 8px 12px;
            border-radius: 15px;
            display: inline-block;
            margin-top: 8px;
        }
        
        /* 行程概览 */
        .overview {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            padding-left: 10px;
        }
        
        .day-overview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .day-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }
        
        .day-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .day-content {
            font-size: 11px;
            color: #555;
            line-height: 1.3;
        }
        
        /* 详细时间表 */
        .schedule {
            margin-bottom: 20px;
        }
        
        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 11px;
        }
        
        .schedule-table th {
            background: #667eea;
            color: white;
            padding: 8px 6px;
            text-align: left;
            font-weight: 500;
        }
        
        .schedule-table td {
            border: 1px solid #ddd;
            padding: 6px;
            vertical-align: top;
        }
        
        .schedule-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .location-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px dotted #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .location-link:hover {
            color: #764ba2;
            border-bottom-color: #764ba2;
        }
        
        .activity-icon {
            margin-right: 4px;
            color: #667eea;
            font-size: 10px;
        }
        
        /* 交通信息 */
        .transport {
            margin-bottom: 20px;
        }
        
        .transport-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .transport-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid #667eea;
        }
        
        .transport-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        .transport-content {
            font-size: 10px;
            color: #555;
            line-height: 1.4;
        }
        
        /* 住宿餐饮 */
        .accommodation {
            margin-bottom: 20px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .info-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }
        
        .info-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        .info-content {
            font-size: 10px;
            color: #555;
            line-height: 1.4;
        }
        
        .info-content ul {
            margin-left: 12px;
        }
        
        .info-content li {
            margin-bottom: 3px;
        }
        
        /* 实用信息 */
        .practical-info {
            background: #f0f7ff;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #b3d9ff;
        }
        
        .practical-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 10px;
        }
        
        .emergency-contacts {
            background: #fff2cc;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ffd966;
        }
        
        .tips {
            background: #e8f5e8;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #93c47d;
        }
        
        /* 打印样式 */
        @media print {
            body {
                background: white;
            }
            
            .travel-plan {
                box-shadow: none;
                margin: 0;
                border-radius: 0;
                width: 100%;
                max-width: none;
            }
            
            .save-image-button {
                display: none !important;
            }
            
            .no-print {
                display: none !important;
            }
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .travel-plan {
                width: 100%;
                margin: 10px;
                padding: 15px;
            }
            
            .day-overview {
                grid-template-columns: 1fr;
            }
            
            .transport-grid,
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .practical-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* 加载提示样式 */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            z-index: 9999;
            font-size: 14px;
            text-align: center;
        }
        
        .price-highlight {
            color: #e74c3c;
            font-weight: 600;
        }
        
        .time-highlight {
            color: #f39c12;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- 保存为图片按钮 -->
    <button class="save-image-button no-print" onclick="saveAsImage()">
        <i class="fas fa-download"></i> 保存为图片
    </button>

    <div class="travel-plan">
        <!-- 标题区域 -->
        <div class="header">
            <h1 class="main-title">深圳到大理三日游</h1>
            <div class="sub-title">旅行日期：2025年6月1日 - 6月3日（星期日至星期二）</div>
            <div class="sub-title">总行程：3天2夜 | 旅行距离：约1,736公里</div>
            <div class="weather-info">
                <i class="fas fa-cloud-sun"></i> 大理天气：多云转小雨 17°C-26°C，北风1-3级
            </div>
        </div>

        <!-- 行程概览 -->
        <div class="overview">
            <h2 class="section-title"><i class="fas fa-calendar-alt"></i> 行程概览</h2>
            <div class="day-overview">
                <div class="day-card">
                    <div class="day-title">第一天 6/1</div>
                    <div class="day-content">
                        深圳出发→大理机场<br>
                        入住酒店→大理古城<br>
                        洋人街→晚餐
                    </div>
                </div>
                <div class="day-card">
                    <div class="day-title">第二天 6/2</div>
                    <div class="day-content">
                        崇圣寺三塔→午餐<br>
                        洱海游船→双廊古镇<br>
                        环海拍照→返回古城
                    </div>
                </div>
                <div class="day-card">
                    <div class="day-title">第三天 6/3</div>
                    <div class="day-content">
                        苍山索道→山顶游览<br>
                        特色午餐→购物<br>
                        大理机场→返回深圳
                    </div>
                </div>
            </div>
        </div>

        <!-- 详细时间表 -->
        <div class="schedule">
            <h2 class="section-title"><i class="fas fa-clock"></i> 详细行程安排</h2>
            
            <!-- 第一天 -->
            <h3 style="color: #667eea; font-size: 14px; margin: 10px 0 8px 0;">第一天 2025年6月1日（星期日）</h3>
            <table class="schedule-table">
                <thead>
                    <tr>
                        <th style="width: 15%;">时间</th>
                        <th style="width: 25%;">活动</th>
                        <th style="width: 35%;">地点</th>
                        <th style="width: 25%;">备注</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="time-highlight">07:30-11:30</td>
                        <td><i class="fas fa-plane activity-icon"></i>航班出行</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(22.543527, 114.057939, '深圳宝安国际机场')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>深圳宝安机场
                            </a> → 
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.678466, 100.301614, '大理凤仪机场')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>大理凤仪机场
                            </a>
                        </td>
                        <td>建议航班：<span class="price-highlight">约600-800元</span><br>提前2小时到机场</td>
                    </tr>
                    <tr>
                        <td class="time-highlight">12:00-13:30</td>
                        <td><i class="fas fa-car activity-icon"></i>机场接送</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '大理古城')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>前往大理古城
                            </a>
                        </td>
                        <td>机场大巴或出租车<br><span class="price-highlight">约50-80元</span></td>
                    </tr>
                    <tr>
                        <td class="time-highlight">14:00-15:00</td>
                        <td><i class="fas fa-bed activity-icon"></i>办理入住</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '大理古城酒店')" class="location-link">
                                <i class="fas fa-home activity-icon"></i>大理古城内客栈
                            </a>
                        </td>
                        <td>休息调整<br><span class="price-highlight">150-300元/晚</span></td>
                    </tr>
                    <tr>
                        <td class="time-highlight">15:30-18:00</td>
                        <td><i class="fas fa-camera activity-icon"></i>古城游览</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '大理古城')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>大理古城步行街
                            </a>
                        </td>
                        <td>免费游览<br>拍照打卡、购买特产</td>
                    </tr>
                    <tr>
                        <td class="time-highlight">18:30-20:00</td>
                        <td><i class="fas fa-utensils activity-icon"></i>特色晚餐</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '洋人街餐厅')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>洋人街美食
                            </a>
                        </td>
                        <td>白族三道茶、过桥米线<br><span class="price-highlight">80-120元/人</span></td>
                    </tr>
                </tbody>
            </table>

            <!-- 第二天 -->
            <h3 style="color: #667eea; font-size: 14px; margin: 15px 0 8px 0;">第二天 2025年6月2日（星期一）</h3>
            <table class="schedule-table">
                <thead>
                    <tr>
                        <th style="width: 15%;">时间</th>
                        <th style="width: 25%;">活动</th>
                        <th style="width: 35%;">地点</th>
                        <th style="width: 25%;">备注</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="time-highlight">08:00-10:00</td>
                        <td><i class="fas fa-temple activity-icon"></i>参观三塔</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.704129, 100.143044, '崇圣寺三塔')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>崇圣寺三塔文化旅游区
                            </a>
                        </td>
                        <td>门票：<span class="price-highlight">75元/人</span><br>佛教文化、古建筑</td>
                    </tr>
                    <tr>
                        <td class="time-highlight">10:30-12:00</td>
                        <td><i class="fas fa-water activity-icon"></i>洱海游船</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.643582, 100.266116, '洱海码头')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>洱海游船码头
                            </a>
                        </td>
                        <td>游船票：<span class="price-highlight">120元/人</span><br>洱海美景、南诏风情岛</td>
                    </tr>
                    <tr>
                        <td class="time-highlight">12:30-14:00</td>
                        <td><i class="fas fa-fish activity-icon"></i>湖鲜午餐</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.908323, 100.194322, '双廊餐厅')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>双廊古镇餐厅
                            </a>
                        </td>
                        <td>洱海鱼、白族菜<br><span class="price-highlight">100-150元/人</span></td>
                    </tr>
                    <tr>
                        <td class="time-highlight">14:30-17:00</td>
                        <td><i class="fas fa-camera activity-icon"></i>双廊游览</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.908323, 100.194322, '双廊古镇')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>双廊古镇景区
                            </a>
                        </td>
                        <td>免费游览<br>渔村风情、洱海美景</td>
                    </tr>
                    <tr>
                        <td class="time-highlight">17:30-19:00</td>
                        <td><i class="fas fa-car activity-icon"></i>环海返程</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '大理古城')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>返回大理古城
                            </a>
                        </td>
                        <td>包车环海<br><span class="price-highlight">200-300元/天</span></td>
                    </tr>
                </tbody>
            </table>

            <!-- 第三天 -->
            <h3 style="color: #667eea; font-size: 14px; margin: 15px 0 8px 0;">第三天 2025年6月3日（星期二）</h3>
            <table class="schedule-table">
                <thead>
                    <tr>
                        <th style="width: 15%;">时间</th>
                        <th style="width: 25%;">活动</th>
                        <th style="width: 35%;">地点</th>
                        <th style="width: 25%;">备注</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="time-highlight">08:30-11:30</td>
                        <td><i class="fas fa-mountain activity-icon"></i>苍山索道</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.704129, 100.143044, '苍山索道')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>苍山洗马潭索道
                            </a>
                        </td>
                        <td>索道票：<span class="price-highlight">280元/人</span><br>高山湖泊、雪山美景</td>
                    </tr>
                    <tr>
                        <td class="time-highlight">12:00-13:30</td>
                        <td><i class="fas fa-utensils activity-icon"></i>特色午餐</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '古城餐厅')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>古城特色餐厅
                            </a>
                        </td>
                        <td>白族土八碗<br><span class="price-highlight">90-130元/人</span></td>
                    </tr>
                    <tr>
                        <td class="time-highlight">14:00-15:30</td>
                        <td><i class="fas fa-shopping-bag activity-icon"></i>购物特产</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '大理古城')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>古城商业街
                            </a>
                        </td>
                        <td>普洱茶、银饰、扎染<br>根据个人预算</td>
                    </tr>
                    <tr>
                        <td class="time-highlight">16:00-17:00</td>
                        <td><i class="fas fa-car activity-icon"></i>前往机场</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(25.678466, 100.301614, '大理凤仪机场')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>大理凤仪机场
                            </a>
                        </td>
                        <td>提前2小时到机场<br><span class="price-highlight">50-80元</span></td>
                    </tr>
                    <tr>
                        <td class="time-highlight">18:30-22:30</td>
                        <td><i class="fas fa-plane activity-icon"></i>返程航班</td>
                        <td>
                            <a href="javascript:void(0)" onclick="navigateToLocation(22.543527, 114.057939, '深圳宝安国际机场')" class="location-link">
                                <i class="fas fa-map-marker-alt activity-icon"></i>深圳宝安机场
                            </a>
                        </td>
                        <td>安全到达深圳<br>结束愉快旅程</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 交通信息 -->
        <div class="transport">
            <h2 class="section-title"><i class="fas fa-route"></i> 交通信息</h2>
            <div class="transport-grid">
                <div class="transport-item">
                    <div class="transport-title"><i class="fas fa-plane"></i> 航班信息</div>
                    <div class="transport-content">
                        <strong>去程：</strong>深圳→大理<br>
                        推荐航班：深航ZH9463（07:30-11:30）<br>
                        票价：约600-800元<br><br>
                        <strong>返程：</strong>大理→深圳<br>
                        推荐航班：深航ZH9464（18:30-22:30）<br>
                        票价：约600-800元
                    </div>
                </div>
                <div class="transport-item">
                    <div class="transport-title"><i class="fas fa-car"></i> 当地交通</div>
                    <div class="transport-content">
                        <strong>机场往返：</strong>机场大巴30元/人<br>
                        出租车约50-80元<br><br>
                        <strong>市内交通：</strong>古城步行为主<br>
                        公交2元/人，出租车起步8元<br><br>
                        <strong>环海交通：</strong>包车200-300元/天<br>
                        电瓶车60元/人
                    </div>
                </div>
            </div>
        </div>

        <!-- 住宿与餐饮 -->
        <div class="accommodation">
            <h2 class="section-title"><i class="fas fa-utensils"></i> 住宿与餐饮</h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-title"><i class="fas fa-bed"></i> 推荐住宿</div>
                    <div class="info-content">
                        <ul>
                            <li>
                                <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '大理古城民宿')" class="location-link">
                                    <strong>大理古城特色客栈</strong>
                                </a><br>
                                位置：古城核心区域<br>
                                价格：150-300元/晚<br>
                                特色：白族建筑风格
                            </li>
                            <li style="margin-top: 8px;">
                                <a href="javascript:void(0)" onclick="navigateToLocation(25.643582, 100.266116, '洱海海景酒店')" class="location-link">
                                    <strong>洱海海景度假酒店</strong>
                                </a><br>
                                位置：洱海边<br>
                                价格：400-800元/晚<br>
                                特色：海景房、设施完善
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-title"><i class="fas fa-utensils"></i> 特色美食</div>
                    <div class="info-content">
                        <ul>
                            <li>
                                <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '白族三道茶')" class="location-link">
                                    <strong>白族三道茶</strong>
                                </a>：苦茶、甜茶、回味茶
                            </li>
                            <li>
                                <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '过桥米线')" class="location-link">
                                    <strong>大理过桥米线</strong>
                                </a>：地道云南风味
                            </li>
                            <li>
                                <a href="javascript:void(0)" onclick="navigateToLocation(25.643582, 100.266116, '洱海鱼')" class="location-link">
                                    <strong>洱海湖鲜</strong>
                                </a>：酸辣鱼、油炸小鱼
                            </li>
                            <li>
                                <a href="javascript:void(0)" onclick="navigateToLocation(25.694836, 100.164000, '白族土八碗')" class="location-link">
                                    <strong>白族土八碗</strong>
                                </a>：传统宴席菜
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- 实用信息 -->
        <div class="practical-info">
            <h2 class="section-title"><i class="fas fa-info-circle"></i> 实用信息</h2>
            <div class="practical-grid">
                <div class="emergency-contacts">
                    <strong><i class="fas fa-phone"></i> 紧急联系</strong><br>
                    旅游咨询：0872-12301<br>
                    紧急救助：110/120/119<br>
                    大理旅游投诉：0872-2316756<br>
                    天气预报：12121
                </div>
                <div class="tips">
                    <strong><i class="fas fa-lightbulb"></i> 重要提示</strong><br>
                    • 6月大理多雨，携带雨具<br>
                    • 高原地区注意防晒<br>
                    • 洱海保护区，禁止乱丢垃圾<br>
                    • 苍山温差大，备好外套
                </div>
                <div style="background: #e3f2fd; padding: 8px; border-radius: 4px; border: 1px solid #90caf9;">
                    <strong><i class="fas fa-wallet"></i> 预算参考</strong><br>
                    机票：1200-1600元<br>
                    住宿：300-600元（2晚）<br>
                    门票：475元/人<br>
                    餐饮：500-800元<br>
                    交通：300-400元<br>
                    <strong>总计：约2775-3875元/人</strong>
                </div>
                <div style="background: #fff3e0; padding: 8px; border-radius: 4px; border: 1px solid #ffb74d;">
                    <strong><i class="fas fa-suitcase"></i> 行李清单</strong><br>
                    • 身份证、现金、银行卡<br>
                    • 防晒霜、太阳镜、帽子<br>
                    • 雨伞、外套、舒适鞋子<br>
                    • 相机、充电宝、常用药品
                </div>
            </div>
        </div>
    </div>

    <script>
        // 保存为图片功能
        function saveAsImage() {
            // 创建加载提示
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'loading';
            loadingDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i><br>正在生成高清图片...';
            document.body.appendChild(loadingDiv);
            
            // 隐藏不需要的元素
            const norintElements = document.querySelectorAll('.no-print');
            norintElements.forEach(el => el.style.display = 'none');
            
            // 使用html2canvas生成图片
            html2canvas(document.querySelector('.travel-plan'), {
                scale: 3, // 高分辨率
                format: 'png',
                backgroundColor: 'white',
                useCORS: true,
                allowTaint: true,
                logging: false,
                width: 794, // A4宽度像素
                height: 1123 // A4高度像素
            }).then(canvas => {
                // 创建下载链接
                const link = document.createElement('a');
                link.download = '深圳到大理三日游行程规划表_2025年6月.png';
                link.href = canvas.toDataURL('image/png', 1.0);
                
                // 触发下载
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // 移除加载提示
                document.body.removeChild(loadingDiv);
                
                // 恢复隐藏的元素
                norintElements.forEach(el => el.style.display = '');
                
                // 显示成功提示
                showNotification('图片已成功保存到下载文件夹！', 'success');
                
            }).catch(err => {
                console.error('图片生成失败:', err);
                document.body.removeChild(loadingDiv);
                norintElements.forEach(el => el.style.display = '');
                showNotification('图片生成失败，请重试', 'error');
            });
        }

        // 高德地图导航功能
        function navigateToLocation(lat, lon, name) {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // 移动端直接调用高德地图APP
                const amapUrl = `amapuri://openFeature?featureName=OnLocationDest&lat=${lat}&lon=${lon}&dev=0&style=2&name=${encodeURIComponent(name)}`;
                window.location.href = amapUrl;
                
                // 如果APP未安装，3秒后跳转到网页版
                setTimeout(() => {
                    const webUrl = `https://uri.amap.com/marker?position=${lon},${lat}&name=${encodeURIComponent(name)}&src=旅行规划&coordinate=gaode&callnative=1`;
                    window.open(webUrl, '_blank');
                }, 3000);
            } else {
                // PC端打开高德地图网页版
                const webUrl = `https://uri.amap.com/marker?position=${lon},${lat}&name=${encodeURIComponent(name)}&src=旅行规划&coordinate=gaode&callnative=1`;
                window.open(webUrl, '_blank');
            }
        }

        // 通知提示功能
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#2196f3'};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                z-index: 10000;
                font-size: 14px;
                max-width: 300px;
                animation: slideInRight 0.3s ease-out;
            `;
            notification.textContent = message;
            
            // 添加动画样式
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // 3秒后自动消失
            setTimeout(() => {
                notification.style.animation = 'slideInRight 0.3s ease-out reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 添加平滑滚动效果
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // 显示欢迎提示
            setTimeout(() => {
                showNotification('点击地点名称可导航至高德地图！', 'info');
            }, 1000);
        });

        // 打印功能
        function printPlan() {
            window.print();
        }

        // 键盘快捷键
        document.addEventListener('keydown', function(e) {
            // Ctrl+S 保存图片
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveAsImage();
            }
            // Ctrl+P 打印
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                printPlan();
            }
        });
    </script>
</body>
</html> 